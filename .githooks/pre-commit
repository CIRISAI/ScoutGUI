#!/bin/bash

# Pre-commit hook for ScoutGUI
# Runs type checking, tests, and build validation

set -e

echo "ğŸ” Running pre-commit checks..."
echo ""

cd apps/agui

# Type checking
echo "ğŸ“ Running type checking..."
if ! pnpm exec tsc --noEmit; then
    echo "âŒ Type checking failed. Please fix TypeScript errors before committing."
    exit 1
fi
echo "âœ… Type checking passed"
echo ""

# Tests
echo "ğŸ§ª Running tests..."
if ! pnpm test --passWithNoTests --silent; then
    echo "âŒ Tests failed. Please fix test errors before committing."
    exit 1
fi
echo "âœ… Tests passed"
echo ""

# Build validation
echo "ğŸ—ï¸  Running build validation..."
if ! pnpm run pages:build > /dev/null 2>&1; then
    echo "âŒ Build failed. Please fix build errors before committing."
    exit 1
fi
echo "âœ… Build passed"
echo ""

echo "âœ… All pre-commit checks passed!"
exit 0
